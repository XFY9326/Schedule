---
title: '注意事项'
---

## 概述

此处将会介绍通用的适配注意事项

## Provider与Parser搭配

Config文件中对Provider与Parser搭配目前只支持以下几种形式：
| 用处                 | Provider              | Parser              |
| -------------------- | --------------------- | ------------------- |
| 模拟登录课程导入     | LoginCourseProvider   | NetworkCourseParser |
| 简单网络请求课程导入 | NetworkCourseProvider | NetworkCourseParser |
| 基于浏览器的课程导入 | WebCourseProvider     | WebCourseParser     |

## Provider与Parser使用事项

1. 两者均通过反射的方式进行实例化，因此不可以添加与修改任何构造函数，指定参数可以使用Config配置
2. 请尽量不要保存动态的Class内全局变量，因为所有实现的方法调用顺序可能会有变化
3. 所有网络请求必须在Provider中实现，不可以混淆Provider与Parser的使用界限
4. 由于参数属性是类构造后才添加的，所以请不要在类初始化就会执行的代码块中使用参数

## Provider与Parser中的泛型参数

为了实现课程提供器/适配器复用，Pure课程表提供了课程提供器/适配器参数的形式  
继承自任意Provider与Parser时会要求填入P泛型参数，P类型指定了传入的参数的类型  
若有参数指定需求，自定义或使用任意实现Serializable接口的类，在Config中设置参数。在Provider与Parser中可以通过params变量或者requireParams()方法获取到  
若无参数指定需求，使用Nothing类型即可  
注：由于每次初始化时都会深拷贝一份供Provider或Parser使用，所以修改该参数并无传递数据的作用

## importOption导入选项

为了能够更加灵活的使用课程导入功能，Pure课程表提供了导入选项功能  
导入选项主要用于同一所学校中研究生/本科生，本学期/下学期等部分操作略有差异但是整体操作相同的情况  
默认情况下传入的导入选项值均为0，若有选中则以选中的文字所在的位置为导入选项的值  

只有在使用NetworkCourseProvider/LoginCourseProvider时，Config中的静态导入选项参数才有用  
如果复写了NetworkCourseProvider/LoginCourseProvider中的onLoadImportOptions函数，那么将会优先考虑该函数返回的选项

在WebCourseProvider中，importOption并非是用户选择的，而是通过解析网页后主动判断得到的

## 课程导入严格模式

对于实际导入课表的用户而言，Pure课程表希望能够提供完整的课程数据  
但是存在部分特殊情况下，用户希望能够导入存在缺陷的课表后自己编辑  
因此Pure课程表提供了‘课程导入严格模式’的功能，可以在‘设置-课程导入-导入设置’中进行调整  
默认情况下，是不允许导入空课表或者跳过部分无法导入的课程的  
为了能够满足以上需求，适配者需要使用到[CourseParseResult 课程解析结果]({{< ref "课程解析工具方法#CourseParseResult" >}})与[错误处理]({{< ref "错误处理" >}})  

## WebView网页调试

Pure课程表提供了三种调试网页的方式：

1. 使用vConsole进行调试（部分网页不兼容）
2. 使用WebView自带的远程调试，在电脑 Chrome (chrome://inspect) / Edge (edge://inspect) 进行调试
3. 查看WebView在Logcat中的输出（需要使用ADB的Logcat）

以上两种方式的调试可以在‘设置-调试-网页调试’中开启，一般建议使用第一或者第二种方法  
开启网页调试功能后，导入课程时执行的JS将会在控制台输出更多方便调试的信息  

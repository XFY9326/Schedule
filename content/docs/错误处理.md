---
title: '错误处理'
---

## 概述

在课程适配中如果出现任何错误情况都可以抛出错误，适配框架会对此进行处理  
建议对于所有已知的错误原因使用CourseAdapterException，这样可以在出错时为用户显示更精确的错误提示  

## 使用方法

CourseAdapterException预置了多种可能发生的错误，调用方法为：

``` kotlin
// 抛出构造的Exception
// cause：导致错误的原因
// msg：错误日志输出的信息
CourseAdapterException.Error.<错误类型枚举>.report(cause: Throwable? = null, msg: String? = null)

// 返回构造的Exception，不抛出
// cause：导致错误的原因
// msg：错误日志输出的信息
CourseAdapterException.Error.<错误类型枚举>.make(cause: Throwable? = null, msg: String? = null)

/* ----- 自定义错误比较特殊，使用以下方法 ----- */

// 抛出构造的自定义错误的Exception
// msg：显示在用户界面的错误信息
// cause：导致错误的原因
CourseAdapterException.reportCustomError(msg: String, cause: Throwable? = null)

// 返回构造的自定义错误的Exception，不抛出
// msg：显示在用户界面的错误信息
// cause：导致错误的原因
CourseAdapterException.makeCustomError(msg: String, cause: Throwable? = null)
```

注1：建议在try {...} catch(e: Exception) {...} 中，使用report方法并将原始错误作为cause参数  
注2：通过report方法对Exception进行包装，可以在错误详情中可以看到原始错误内容  

相关：[CourseParseResult 课程解析结果]({{< ref "课程解析工具方法#CourseParseResult" >}})

## 错误类型枚举

此处仅列举适配者可以使用的枚举量，除非特殊说明，否则均为**不可以忽略的错误（严格模式）**  
CourseAdapterException.Error还存在其他的枚举量，这些为课程导入时会自动判断的错误  
不建议手动调用，因为手动调用可能导致重复报错，更多信息详见CourseAdapterException.Error源码

| 枚举量                       | 用处                                                                      |
| ---------------------------- | ------------------------------------------------------------------------- |
| IMPORT_SELECT_OPTION_ERROR   | 主要用于未知的导入选项导致的错误                                          |
| PARSE_PAGE_ERROR             | 主要用于传入的页面无法解析导致的错误                                      |
| USER_ID_ERROR                | 主要用于用户名错误导致的无法登录                                          |
| USER_PASSWORD_ERROR          | 主要用于密码错误导致的无法登录                                            |
| USER_ID_OR_PASSWORD_ERROR    | 主要用于用户名或密码错误导致的无法登录                                    |
| LOGIN_SERVER_ERROR           | 主要用于登录服务器错误                                                    |
| ACCOUNT_ERROR                | 主要用于登录账号错误                                                      |
| INCOMPLETE_COURSE_INFO_ERROR | 主要用于课程信息不完整导致的错误                                          |
| CONTENT_PARSE_ERROR          | 主要用于内容解析导致的错误<br/>**严格模式下启用，即可以忽略或跳过的错误** |
| CAPTCHA_CODE_ERROR           | 主要用于验证码错误                                                        |
| JSON_PARSE_ERROR             | 主要用于JSON解析错误                                                      |
| CUSTOM_ERROR                 | 用于自定义显示的错误提示，详见[自定义错误]({{< ref "#自定义错误" >}})     |

相关：[课程导入严格模式]({{< ref "注意事项#课程导入严格模式" >}})

## 自定义错误

自定义错误的设计目的是**针对特殊情况下，错误类型过多且可以获取明确错误内容时使用**  
若是可以添加固定的错误类型，最好不要使用自定义错误的类型  
自定义错误需要使用特殊的方法设定该类错误的具体内容：  

``` kotlin
CourseAdapterException.reportCustomError()  
CourseAdapterException.makeCustomError()
```

自定义错误使用时reportCustomError与makeCustomError方法的msg参数，是**显示在用户界面上的提示语**  
普通错误类型使用时report与make方法的msg参数，是查看错误报告时，**错误log输出的message**
